<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Filter a comparison to include only the best hits for each query — best_hit • genoPlotR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Filter a comparison to include only the best hits for each query — best_hit"><meta name="description" content="Takes a comparison object and filters it to include only the best hit
for each query. The query names are provided by group_by, and the best hit
is determined by sorting each set of queries based on a set of columns
provided by sort_order."><meta property="og:description" content="Takes a comparison object and filters it to include only the best hit
for each query. The query names are provided by group_by, and the best hit
is determined by sorting each set of queries based on a set of columns
provided by sort_order."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">genoPlotR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/genoPlotR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/wrapper_script.html">Running genoPlotR from a command-line interface</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Filter a comparison to include only the best hits for each query</h1>

      <div class="d-none name"><code>best_hit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Takes a <code>comparison</code> object and filters it to include only the best hit
for each query. The query names are provided by <code>group_by</code>, and the best hit
is determined by sorting each set of queries based on a set of columns
provided by <code>sort_order</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">best_hit</span><span class="op">(</span></span>
<span>  <span class="va">comparison</span>,</span>
<span>  group_by <span class="op">=</span> <span class="st">"name1"</span>,</span>
<span>  sort_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bit_score"</span>, <span class="st">"aln_len"</span>, <span class="st">"per_id"</span>, <span class="st">"direction"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-comparison">comparison<a class="anchor" aria-label="anchor" href="#arg-comparison"></a></dt>
<dd><p>A <code>comparison</code> object to filter.</p></dd>


<dt id="arg-group-by">group_by<a class="anchor" aria-label="anchor" href="#arg-group-by"></a></dt>
<dd><p>A character string referring to a column in <code>comparison</code>
that holds the query names.</p></dd>


<dt id="arg-sort-order">sort_order<a class="anchor" aria-label="anchor" href="#arg-sort-order"></a></dt>
<dd><p>A character vector of column names that determine what the
best hit is, in order of importance. The first column is used to determine
the best hits per query, and each subsequent column is only used in case of
ties.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>comparison</code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Designed to find the best hits per query from <code>comparison</code> objects
generated from tabular BLAST or DIAMOND results. For each column from
<code>sort_order</code>, the maximum (or minimum) value is taken for each unique query
name from <code>group_by</code>, in the order provided by <code>sort_order</code>, until each query
only 1 hit left. The maximum values are taken for each <code>sort_order</code> column,
unless the column provided is one of: <code>"mism"</code>, <code>"gaps"</code>, <code>"e_value"</code>,
<code>"name1"</code>, <code>"name2"</code>, <code>"start1"</code>, <code>"start2"</code>, <code>"end1"</code>, or <code>"end2"</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="bidirectional_best_hit.html">bidirectional_best_hit</a>, <a href="comparison.html">comparison</a>, <a href="run_sequence_alignment.html">run_blast</a>, <a href="run_sequence_alignment.html">run_diamond</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Mike Puijk</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Read example blastp results</span></span></span>
<span class="r-in"><span><span class="va">infile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/blastp_example1.tab'</span>, package <span class="op">=</span> <span class="st">'genoPlotR'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## comparison before filtering for best hits</span></span></span>
<span class="r-in"><span><span class="va">blast_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_comparison.html">read_comparison_from_blast</a></span><span class="op">(</span><span class="va">infile</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="print_comparison.html">print_comparison</a></span><span class="op">(</span><span class="va">blast_comparison</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     start1  end1 start2  end2          name1          name2 per_id aln_len</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;int&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt;         &lt;char&gt;         &lt;char&gt;  &lt;num&gt;   &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:    117   502      1   385 HKIDPCCJ_00001 LABPAKCO_00001   58.7     387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:      1   376      1   379 HKIDPCCJ_00002 LABPAKCO_00002   56.5     379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:     19   651     12   645 HKIDPCCJ_00004 LABPAKCO_00005   74.6     634</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:     23   655      8   644 HKIDPCCJ_00004 LABPAKCO_01957   51.4     642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:     11   811     10   812 HKIDPCCJ_00005 LABPAKCO_00006   62.8     803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:     11   810      6   809 HKIDPCCJ_00005 LABPAKCO_01958   40.0     817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:      1   172      1   190 HKIDPCCJ_00007 LABPAKCO_00009   55.8     197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:      1   172      1   164 HKIDPCCJ_00007 LABPAKCO_02342   50.0     174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:     93   535     67   509 HKIDPCCJ_00029 LABPAKCO_00168   28.7     453</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:     87   521    107   546 HKIDPCCJ_00029 LABPAKCO_00977   26.3     452</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:    328   529    335   539 HKIDPCCJ_00029 LABPAKCO_01459   33.2     205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:     88   534    100   548 HKIDPCCJ_00029 LABPAKCO_01460   23.7     451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:    304   498    312   502 HKIDPCCJ_00029 LABPAKCO_02399   31.3     201</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:    328   521     28   227 HKIDPCCJ_00029 LABPAKCO_02526   29.8     208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:    328   519      4   214 HKIDPCCJ_00029 LABPAKCO_01272   29.1     213</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:      1   637      1   644 HKIDPCCJ_00034 LABPAKCO_00103   56.1     645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:      2   210     11   270 HKIDPCCJ_00034 LABPAKCO_01390   31.5     260</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:      8   303     12   290 HKIDPCCJ_00034 LABPAKCO_01699   30.1     306</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:    100   531     78   511 HKIDPCCJ_00038 LABPAKCO_00168   24.1     456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:    250   513    267   544 HKIDPCCJ_00038 LABPAKCO_00977   26.1     284</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:    267   513    290   533 HKIDPCCJ_00038 LABPAKCO_01460   27.6     254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:    325   503    331   513 HKIDPCCJ_00038 LABPAKCO_02399   28.1     185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:    109   473    105   460 HKIDPCCJ_00038 LABPAKCO_01612   22.5     374</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:    359   501    368   516 HKIDPCCJ_00038 LABPAKCO_01459   29.6     152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:    320   514     22   226 HKIDPCCJ_00038 LABPAKCO_02526   25.8     209</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26:    323   485      2   187 HKIDPCCJ_00038 LABPAKCO_01272   22.1     204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27:    451   514    331   398 HKIDPCCJ_00038 LABPAKCO_00394   32.4      68</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28:      8   338      4   334 HKIDPCCJ_00047 LABPAKCO_00854   54.1     333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29:      4   336      1   333 HKIDPCCJ_00047 LABPAKCO_02361   27.1     336</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30:      1   442      1   443 HKIDPCCJ_00048 LABPAKCO_01328   33.8     444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31:      1   438      1   440 HKIDPCCJ_00048 LABPAKCO_02752   32.4     442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32:      1   379      1   378 HKIDPCCJ_00049 LABPAKCO_00839   72.5     382</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33:     15   348      9   310 HKIDPCCJ_00049 LABPAKCO_00753   32.2     342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     start1  end1 start2  end2          name1          name2 per_id aln_len</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mism  gaps   e_value bit_score direction</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;int&gt; &lt;int&gt;     &lt;num&gt;     &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:   157     2 1.32e-153     440.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:   162     1 1.18e-140     401.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:   160     1  0.00e+00     946.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:   298    11 9.19e-211     601.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:   297     1  0.00e+00     989.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:   460     7 4.55e-185     547.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:    55     2  2.90e-56     172.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:    75     2  8.61e-50     154.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:   303    10  3.22e-49     174.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:   304    13  2.30e-31     124.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:   134     3  3.10e-30     120.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:   338     6  4.45e-29     117.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:   122     4  2.08e-22      97.1         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:   124     6  2.37e-14      69.7         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:   128     7  3.15e-14      71.2         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:   274     5 7.15e-256     715.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:   127     4  8.69e-31     124.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:   177    10  5.54e-24     102.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:   300     9  3.02e-28     114.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:   184     8  3.67e-21      93.2         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:   167     6  5.92e-19      86.3         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:   125     2  9.99e-18      82.4         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:   263     7  2.73e-17      80.9         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:    95     3  1.32e-12      66.2         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:   137     6  9.21e-11      58.9         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26:   100     7  6.56e-05      41.6         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27:    42     2  2.91e-04      39.7         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28:   149     3 6.03e-110     322.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29:   239     4  5.43e-29     111.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30:   291     3  2.02e-80     252.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31:   293     4  7.28e-74     235.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32:    98     3 5.42e-194     537.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33:   184    11  4.93e-43     149.0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mism  gaps   e_value bit_score direction</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Filter for best hits and print results</span></span></span>
<span class="r-in"><span><span class="va">bh_comparison</span> <span class="op">&lt;-</span> <span class="fu">best_hit</span><span class="op">(</span><span class="va">blast_comparison</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="print_comparison.html">print_comparison</a></span><span class="op">(</span><span class="va">bh_comparison</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     start1  end1 start2  end2          name1          name2 per_id aln_len</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;int&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt;         &lt;char&gt;         &lt;char&gt;  &lt;num&gt;   &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:    117   502      1   385 HKIDPCCJ_00001 LABPAKCO_00001   58.7     387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:      1   376      1   379 HKIDPCCJ_00002 LABPAKCO_00002   56.5     379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:     19   651     12   645 HKIDPCCJ_00004 LABPAKCO_00005   74.6     634</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:     11   811     10   812 HKIDPCCJ_00005 LABPAKCO_00006   62.8     803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:      1   172      1   190 HKIDPCCJ_00007 LABPAKCO_00009   55.8     197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:     93   535     67   509 HKIDPCCJ_00029 LABPAKCO_00168   28.7     453</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:      1   637      1   644 HKIDPCCJ_00034 LABPAKCO_00103   56.1     645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:    100   531     78   511 HKIDPCCJ_00038 LABPAKCO_00168   24.1     456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:      8   338      4   334 HKIDPCCJ_00047 LABPAKCO_00854   54.1     333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:      1   442      1   443 HKIDPCCJ_00048 LABPAKCO_01328   33.8     444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:      1   379      1   378 HKIDPCCJ_00049 LABPAKCO_00839   72.5     382</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mism  gaps   e_value bit_score direction</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;int&gt; &lt;int&gt;     &lt;num&gt;     &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:   157     2 1.32e-153       440         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:   162     1 1.18e-140       401         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:   160     1  0.00e+00       946         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:   297     1  0.00e+00       989         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:    55     2  2.90e-56       172         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:   303    10  3.22e-49       174         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:   274     5 7.15e-256       715         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:   300     9  3.02e-28       114         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:   149     3 6.03e-110       322         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:   291     3  2.02e-80       252         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:    98     3 5.42e-194       537         1</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mike Puijk.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

