<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Auto-annotate dna_segs — auto_annotate • genoPlotR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Auto-annotate dna_segs — auto_annotate"><meta name="description" content="Annotate dna_segs in a smart way. This is especially designed for
dna_segs read from GenBank or EMBL files, but can be used for other
purposes as well. With the default arguments, it produces annotation
objects based on the gene attribute of dna_segs."><meta property="og:description" content="Annotate dna_segs in a smart way. This is especially designed for
dna_segs read from GenBank or EMBL files, but can be used for other
purposes as well. With the default arguments, it produces annotation
objects based on the gene attribute of dna_segs."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">genoPlotR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/genoPlotR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/wrapper_script.html">Running genoPlotR from a command-line interface</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Auto-annotate dna_segs</h1>

      <div class="d-none name"><code>auto_annotate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Annotate <code>dna_segs</code> in a smart way. This is especially designed for
<code>dna_segs</code> read from GenBank or EMBL files, but can be used for other
purposes as well. With the default arguments, it produces <code>annotation</code>
objects based on the <code>gene</code> attribute of <code>dna_segs</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">auto_annotate</span><span class="op">(</span></span>
<span>  <span class="va">dna_seg_input</span>,</span>
<span>  names <span class="op">=</span> <span class="st">"gene"</span>,</span>
<span>  basic_mode <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  locus_tag_pattern <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  keep_genes_only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dna_seg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dna-seg-input">dna_seg_input<a class="anchor" aria-label="anchor" href="#arg-dna-seg-input"></a></dt>
<dd><p>Either a single <code>dna_seg</code> or a list of <code>dna_seg</code>
objects.</p></dd>


<dt id="arg-names">names<a class="anchor" aria-label="anchor" href="#arg-names"></a></dt>
<dd><p>A character string with the name of a <code>dna_seg</code> attribute, to
base the annotations on. If <code>dna_seg_input</code> is a single <code>dna_seg</code>, it
can also be a character vector with as many elements as there are rows in
that <code>dna_seg</code>.</p></dd>


<dt id="arg-basic-mode">basic_mode<a class="anchor" aria-label="anchor" href="#arg-basic-mode"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, annotate the <code>dna_seg_input</code> using the
<code>names</code> argument, ignoring all other arguments and never generating spanning
annotations.</p></dd>


<dt id="arg-locus-tag-pattern">locus_tag_pattern<a class="anchor" aria-label="anchor" href="#arg-locus-tag-pattern"></a></dt>
<dd><p>A character string giving a pattern, used to
simplify names. To turn this off, use <code>locus_tag_pattern = ""</code>. See details.</p></dd>


<dt id="arg-keep-genes-only">keep_genes_only<a class="anchor" aria-label="anchor" href="#arg-keep-genes-only"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, then for any row where <code>names</code> is
<code>"-"</code>, <code>"NA"</code>, or empty (<code>""</code>), no annotations will be made. See details.</p></dd>


<dt id="arg-dna-seg">dna_seg<a class="anchor" aria-label="anchor" href="#arg-dna-seg"></a></dt>
<dd><p>Deprecated, included for backwards compatibility.
When provided, replaces <code>dna_seg_input</code>.
it.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments to be passed to the <code>annotation</code> function,
like <code>rot</code> or <code>col</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>dna_seg_input</code> is a single <code>dna_seg</code>, then a single
<code>annotation</code> object will be returned.</p>
<p>If <code>dna_seg_input</code> is a list of <code>dna_seg</code> objects, a list of
<code>annotation</code> objects will be returned of equal length.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>keep_genes_only</code> is intended to be used with the <code>gene</code> column. When <code>TRUE</code>,
it will only make annotations for <code>names</code> that are not 'empty' (<code>"-"</code>,
<code>"NA"</code>, or <code>""</code>). When it is <code>FALSE</code> however, <code>locus_tag_pattern</code> becomes
relevant. For any element of <code>names</code> that is 'empty', it will take the <code>name</code>
attribute of the <code>dna_seg</code> and remove the <code>locus_tag_pattern</code> from it
(e.g. <code>Eco003456</code> becomes <code>003456</code>, with <code>Eco</code> as the <code>locus_tag_pattern</code>).
If <code>locus_tag_pattern</code> is left as <code>NULL</code> it will attempt to determine a
common prefix automatically. To turn this behavior off, use
<code>locus_tag_pattern = ""</code>.</p>
<p>If <code>names</code> refers to gene names, it will create spanning annotations for
operons or sequences of genes. For this to work, gene names have to be
consecutive and end with a number or capital letter.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="annotation.html">annotation</a>, <a href="dna_seg.html">dna_seg</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Lionel Guy, Mike Puijk</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Prepare dna_seg</span></span></span>
<span class="r-in"><span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Eco"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%04d"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-"</span>, <span class="st">"atpC"</span>, <span class="st">"atpB"</span>, <span class="st">"atpA"</span>, <span class="st">"atp2"</span>, </span></span>
<span class="r-in"><span>          <span class="st">"-"</span>, <span class="st">"-"</span>, <span class="st">"cda1"</span>, <span class="st">"cda2"</span>, <span class="st">"cda3"</span>,</span></span>
<span class="r-in"><span>          <span class="st">"vcx23"</span>, <span class="st">"vcx22"</span>, <span class="st">"vcx21"</span>, <span class="st">"cde20"</span>,</span></span>
<span class="r-in"><span>          <span class="st">"-"</span>, <span class="st">"gfrU"</span>, <span class="st">"gfrT"</span>, <span class="st">"gfrY"</span>, <span class="st">"gfrX"</span>, <span class="st">"gfrW"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="dna_seg.html">dna_seg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>name <span class="op">=</span> <span class="va">names</span>,</span></span>
<span class="r-in"><span>                         start <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span> <span class="op">*</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                         end <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span> <span class="op">*</span> <span class="fl">3</span> <span class="op">+</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                         strand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         gene <span class="op">=</span> <span class="va">gene</span>,</span></span>
<span class="r-in"><span>                         stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Original annotation</span></span></span>
<span class="r-in"><span><span class="va">annot1</span> <span class="op">&lt;-</span> <span class="fu"><a href="annotation.html">annotation</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fu"><a href="middle.html">middle</a></span><span class="op">(</span><span class="va">ds</span><span class="op">)</span>, text <span class="op">=</span> <span class="va">ds</span><span class="op">$</span><span class="va">gene</span>, rot <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## auto_annotate with various options</span></span></span>
<span class="r-in"><span><span class="va">annot2</span> <span class="op">&lt;-</span> <span class="fu">auto_annotate</span><span class="op">(</span><span class="va">ds</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">annot3</span> <span class="op">&lt;-</span> <span class="fu">auto_annotate</span><span class="op">(</span><span class="va">ds</span>, keep_genes_only <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                        locus_tag_pattern <span class="op">=</span> <span class="st">""</span>, rot <span class="op">=</span> <span class="fl">75</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">annot4</span> <span class="op">&lt;-</span> <span class="fu">auto_annotate</span><span class="op">(</span><span class="va">ds</span>, keep_genes_only <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_gene_map.html">plot_gene_map</a></span><span class="op">(</span>dna_segs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ds</span>, <span class="va">ds</span>, <span class="va">ds</span>, <span class="va">ds</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              annotations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">annot1</span>, <span class="va">annot2</span>, <span class="va">annot3</span>, <span class="va">annot4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="auto_annotate-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mike Puijk.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

